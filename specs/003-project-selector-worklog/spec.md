# Feature Specification: 工数入力画面のプロジェクト選択機能

**Feature Branch**: `003-project-selector-worklog`  
**Created**: 2025-01-20  
**Status**: Draft  
**Input**: User description: "工数入力画面のプロジェクトを自分にアサインされているプロジェクト一覧を取得してプロジェクト名をみて選択できるようにしたい。"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - アサインされたプロジェクト一覧からの選択 (Priority: P1)

ユーザーとして、工数入力画面でプロジェクトを入力する際、自分にアサインされているプロジェクトの一覧から選択したい。これにより、プロジェクトIDを手動で入力する手間が省け、入力ミスを防止できる。

**Why this priority**: これが機能の核心であり、ユーザーの主要な課題（プロジェクトIDの手動入力とその誤り）を直接解決する。

**Independent Test**: プロジェクト選択ドロップダウンを開き、プロジェクト名を確認して選択することで、工数入力が正常に保存されることを確認できる。

**Acceptance Scenarios**:

1. **Given** ユーザーが工数入力フォームを開いている, **When** プロジェクト選択フィールドをクリックする, **Then** 自分にアサインされているアクティブなプロジェクトの一覧が表示される

2. **Given** プロジェクト一覧が表示されている, **When** プロジェクト名をクリックして選択する, **Then** 選択したプロジェクトがフィールドに設定され、その後工数を入力して保存できる

3. **Given** 複数のプロジェクトがアサインされている, **When** プロジェクト一覧を表示する, **Then** プロジェクトはプロジェクト名で識別でき、プロジェクトコードも併せて表示される

---

### User Story 2 - プロジェクト名での検索・フィルタリング (Priority: P2)

ユーザーとして、多数のプロジェクトがアサインされている場合でも、プロジェクト名の一部を入力して素早く目的のプロジェクトを見つけたい。

**Why this priority**: 多数のプロジェクトを持つユーザーの利便性を向上させるが、少数のプロジェクトしかない場合でも基本機能（P1）で十分に使用可能。

**Independent Test**: プロジェクト選択フィールドにテキストを入力し、一致するプロジェクトのみがフィルタリングされて表示されることを確認できる。

**Acceptance Scenarios**:

1. **Given** プロジェクト一覧が表示されている, **When** プロジェクト名の一部（例：「開発」）を入力する, **Then** 入力した文字列を含むプロジェクトのみが表示される

2. **Given** フィルタリングされた一覧が表示されている, **When** 入力をクリアする, **Then** 全てのアサインされたプロジェクトが再度表示される

---

### User Story 3 - プロジェクトがない場合の対応 (Priority: P3)

ユーザーとして、自分にプロジェクトがアサインされていない場合、明確なメッセージを見て状況を理解したい。

**Why this priority**: エッジケースへの対応であり、基本機能の完成後に対応すべき。

**Independent Test**: プロジェクトがアサインされていないユーザーでログインし、適切なメッセージが表示されることを確認できる。

**Acceptance Scenarios**:

1. **Given** ユーザーにプロジェクトがアサインされていない, **When** 工数入力フォームを開く, **Then** 「プロジェクトがアサインされていません」というメッセージが表示される

---

### Edge Cases

- アサインされたプロジェクトがすべて非アクティブの場合、どうなるか？
  - **対応**: 空の一覧が表示され、「アクティブなプロジェクトがありません」というメッセージを表示する
- プロジェクト一覧の取得中にエラーが発生した場合、どうなるか？
  - **対応**: エラーメッセージを表示し、リトライ可能な状態にする
- 既存の工数エントリを編集する場合、すでに選択されているプロジェクトはどうなるか？
  - **対応**: 既存のプロジェクトが選択済み状態で表示され、変更不可とする（現行動作の維持）

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: システムは、ログインユーザーにアサインされているプロジェクト一覧を取得できなければならない
- **FR-002**: システムは、プロジェクト一覧をプロジェクト名とプロジェクトコードで表示しなければならない
- **FR-003**: ユーザーは、プロジェクト一覧からプロジェクトを選択できなければならない
- **FR-004**: システムは、アクティブなプロジェクトのみを一覧に表示しなければならない
- **FR-005**: ユーザーは、プロジェクト名またはコードの一部を入力して一覧をフィルタリングできなければならない
- **FR-006**: システムは、選択されたプロジェクトのIDを工数エントリに保存しなければならない
- **FR-007**: システムは、プロジェクトがアサインされていない場合、適切なメッセージを表示しなければならない
- **FR-008**: システムは、既存の工数エントリについては、プロジェクトの変更を許可しない（現行動作の維持）

### Key Entities

- **Project（プロジェクト）**: ユーザーが工数を記録する対象。プロジェクトID、プロジェクトコード、プロジェクト名、アクティブ状態を持つ
- **ProjectAssignment（プロジェクトアサイン）**: ユーザーとプロジェクトの関連。どのユーザーがどのプロジェクトに参加しているかを表す

### Assumptions

- ユーザーとプロジェクトのアサイン情報は既にバックエンドで管理されている
- プロジェクト一覧を取得するAPIエンドポイントが存在するか、新規作成する必要がある
- プロジェクトは一意のIDとコードを持ち、人間が読みやすいプロジェクト名も持つ

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: ユーザーは3クリック以内でプロジェクトを選択して工数を入力開始できる
- **SC-002**: プロジェクト選択時の入力ミス（存在しないプロジェクトIDの入力）が0件になる
- **SC-003**: 95%のユーザーが初回使用時に補助なくプロジェクト選択を完了できる
- **SC-004**: プロジェクト一覧は2秒以内に表示される
- **SC-005**: 20件以上のプロジェクトがあるユーザーでも、フィルタリング機能により5秒以内に目的のプロジェクトを見つけられる
