# Production configuration for Work-Log backend
# Activated via: SPRING_PROFILES_ACTIVE=prod

spring:
  # Database - use environment variables
  datasource:
    url: ${SPRING_DATASOURCE_URL:jdbc:postgresql://localhost:5432/worklog}
    username: ${SPRING_DATASOURCE_USERNAME:worklog}
    password: ${SPRING_DATASOURCE_PASSWORD}
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000

  flyway:
    enabled: true
    locations: classpath:db/migration

# Production server settings
server:
  servlet:
    session:
      timeout: 30m
      cookie:
        http-only: true
        secure: true  # HTTPS required in production
        same-site: strict
  # Trust proxy headers (X-Forwarded-*)
  forward-headers-strategy: framework

# Production worklog settings
worklog:
  rate-limit:
    enabled: true
    requests-per-second: ${RATE_LIMIT_RPS:20}
    burst-size: ${RATE_LIMIT_BURST:50}
    cleanup-interval-minutes: 5
  logging:
    enabled: true
    include-request-body: false  # Disable body logging in production for performance
    include-response-body: false
    max-body-length: 500

# Production logging
logging:
  level:
    root: WARN
    com.worklog: INFO
    org.springframework.security: WARN
    org.springframework.web: WARN
    org.hibernate: WARN
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"

# Actuator endpoints for health checks
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: when_authorized
