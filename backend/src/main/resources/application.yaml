spring:
  datasource:
    url: jdbc:postgresql://localhost:5432/worklog
    username: worklog
    password: worklog

  flyway:
    enabled: true
    locations: classpath:db/migration

  # Mail Configuration for email verification and password reset
  mail:
    host: ${MAIL_HOST:localhost}
    port: ${MAIL_PORT:1025}
    username: ${MAIL_USERNAME:}
    password: ${MAIL_PASSWORD:}
    properties:
      mail:
        smtp:
          auth: ${MAIL_SMTP_AUTH:false}
          starttls:
            enable: ${MAIL_SMTP_STARTTLS:false}
            required: false
        debug: ${MAIL_DEBUG:false}
    test-connection: false

  # Redis Configuration - disabled by default for development
  # Enable with worklog.cache.enabled=true
  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
      password: ${REDIS_PASSWORD:}
      timeout: 2000ms
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 2
          max-wait: -1ms

  # OAuth2/OIDC Configuration - DISABLED FOR DEVELOPMENT
  # Configure via environment variables or override in application-{profile}.yaml when needed
  # security:
  #   oauth2:
  #     client:
  #       registration:
  #         azure:
  #           provider: azure
  #           client-id: ${AZURE_CLIENT_ID:changeme}
  #           client-secret: ${AZURE_CLIENT_SECRET:changeme}
  #           authorization-grant-type: authorization_code
  #           scope: openid,profile,email
  #       provider:
  #         azure:
  #           issuer-uri: ${AZURE_ISSUER_URI:https://login.microsoftonline.com/common/v2.0}
    
  # SAML2 Configuration - DISABLED FOR DEVELOPMENT
  # Configure via environment variables or override in application-{profile}.yaml when needed
  # security:
  #   saml2:
  #     relyingparty:
  #       registration:
  #         okta:
  #           signing:
  #             credentials:
  #               - private-key-location: ${SAML_PRIVATE_KEY_LOCATION:classpath:saml-rp.key}
  #                 certificate-location: ${SAML_CERTIFICATE_LOCATION:classpath:saml-rp.crt}
  #           assertingparty:
  #             entity-id: ${OKTA_ISSUER:changeme}
  #             verification:
  #               credentials:
  #                 - certificate-location: ${OKTA_CERTIFICATE_LOCATION:classpath:okta-idp.crt}
  #             singlesignon:
  #               url: ${OKTA_SSO_URL:changeme}
  #               sign-request: true

# Session Management
server:
  servlet:
    session:
      timeout: 30m  # 30-minute session timeout
      cookie:
        http-only: true  # Prevent XSS attacks
        secure: ${SESSION_COOKIE_SECURE:false}  # Set to true in production (HTTPS)
        same-site: lax  # CSRF protection

# Rate Limiting Configuration
worklog:
  # Cache Configuration (Redis)
  cache:
    enabled: ${CACHE_ENABLED:false}
    ttl-minutes: ${CACHE_TTL_MINUTES:5}
  rate-limit:
    enabled: ${RATE_LIMIT_ENABLED:true}
    requests-per-second: ${RATE_LIMIT_RPS:10}
    burst-size: ${RATE_LIMIT_BURST:20}
    cleanup-interval-minutes: 5
  # Request/Response Logging with sensitive data masking
  logging:
    enabled: ${REQUEST_LOGGING_ENABLED:true}
    include-request-body: ${REQUEST_LOGGING_BODY:true}
    include-response-body: ${RESPONSE_LOGGING_BODY:false}
    max-body-length: ${LOGGING_MAX_BODY:1000}
